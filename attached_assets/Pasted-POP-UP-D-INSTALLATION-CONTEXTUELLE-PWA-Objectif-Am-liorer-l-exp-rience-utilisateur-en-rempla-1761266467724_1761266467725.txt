POP-UP Dâ€™INSTALLATION CONTEXTUELLE (PWA)

ğŸ¯ Objectif :
AmÃ©liorer lâ€™expÃ©rience utilisateur en remplaÃ§ant le bouton fixe â€œInstaller CamionBackâ€ (actuellement en bas dâ€™Ã©cran) par une pop-up dâ€™installation contextuelle (toast), Ã©lÃ©gante et intelligente.
Cette pop-up doit apparaÃ®tre au bon moment, sans perturber la navigation, et encourager les nouveaux visiteurs Ã  installer la PWA sans agression visuelle.

ğŸ§© 1ï¸âƒ£ Pourquoi ce changement

Le bouton fixe actuel en bas de page perturbe lâ€™expÃ©rience :

Il chevauche les CTA principaux du tableau de bord (modifier, accepter, etc.).

Il gÃªne la lecture et donne une impression dâ€™encombrement visuel.

Sur mobile, lâ€™utilisateur doit garder un espace clair pour interagir facilement.

Lâ€™objectif est dâ€™obtenir un Ã©quilibre entre visibilitÃ© et discrÃ©tion.

ğŸ’¡ En UX moderne, un â€œtoast dâ€™installation contextuelâ€ est beaucoup plus fluide :
il apparaÃ®t quand lâ€™utilisateur est rÃ©ceptif, reste lÃ©ger, et disparaÃ®t sans gÃªner.

ğŸ§  2ï¸âƒ£ Fonctionnement attendu

La pop-up â€œInstaller CamionBackâ€ sâ€™affiche :

Uniquement si lâ€™app nâ€™est pas dÃ©jÃ  installÃ©e (PWA non active)

AprÃ¨s 5 Ã  10 secondes dâ€™inactivitÃ© (aucun scroll, clic ou tap)

Une seule fois par session (jusquâ€™Ã  ce que lâ€™utilisateur clique sur Installer ou Plus tard)

AprÃ¨s interaction :

Si lâ€™utilisateur clique sur â€œInstallerâ€ â†’ lancer le prompt PWA (beforeinstallprompt).

Si lâ€™utilisateur clique sur â€œPlus tardâ€ â†’ cacher la pop-up et stocker un flag dans localStorage (pwaPromptDismissed=true).

ğŸ–¼ï¸ 3ï¸âƒ£ Design et positionnement
ğŸ“± Position :

En haut Ã  droite sur desktop

En bas Ã  droite sur mobile (style toast flottant)

ğŸ¨ Apparence :

Style â€œcarte flottanteâ€ avec lÃ©gÃ¨re ombre et coins arrondis (border-radius: 10px)

Fond clair (#ffffff ou #f9fbfc) avec une ombre douce (rgba(0,0,0,0.15))

IcÃ´ne ğŸ“² Ã  gauche du texte

Boutons :

Installer (vert principal #00BFA5)

Plus tard (texte gris neutre)

Animation dâ€™apparition en fade + slide (0.4s)

Disparition automatique au bout de 15 secondes si aucune action nâ€™est faite.

Exemple visuel :

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
ğŸ“²  Installez CamionBack pour un accÃ¨s rapide !
[Installer]     [Plus tard]
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âš™ï¸ 4ï¸âƒ£ Logique technique

DÃ©tection PWA :

VÃ©rifier window.matchMedia('(display-mode: standalone)').matches

OU tester la prÃ©sence du beforeinstallprompt event.

Gestion du timing :

DÃ©clencher la pop-up aprÃ¨s setTimeout(10000) (10 secondes dâ€™inactivitÃ©).

RÃ©initialiser le timer dÃ¨s que lâ€™utilisateur interagit.

Gestion du stockage :

Si localStorage.getItem('pwaPromptDismissed') === true, ne plus afficher.

Actions :

Installer â†’ dÃ©clencher le prompt PWA capturÃ©.

Plus tard â†’ cacher la pop-up + stocker pwaPromptDismissed=true.

Animation et UX :

Transition douce (fade + slide-up / slide-down).

Responsive (mobile friendly, pas de chevauchement dâ€™Ã©lÃ©ments).

ğŸ§© 5ï¸âƒ£ Exemple de logique JS simplifiÃ©e :
let deferredPrompt;

window.addEventListener('beforeinstallprompt', (e) => {
  e.preventDefault();
  deferredPrompt = e;
});

function showInstallToast() {
  if (localStorage.getItem('pwaPromptDismissed')) return;
  const toast = document.createElement('div');
  toast.classList.add('install-toast');
  toast.innerHTML = `
    <div class="toast-content">
      <span>ğŸ“² Installez CamionBack pour un accÃ¨s rapide !</span>
      <div class="toast-actions">
        <button id="installBtn">Installer</button>
        <button id="laterBtn">Plus tard</button>
      </div>
    </div>
  `;
  document.body.appendChild(toast);

  document.getElementById('installBtn').onclick = async () => {
    toast.remove();
    if (deferredPrompt) {
      deferredPrompt.prompt();
      const choice = await deferredPrompt.userChoice;
      if (choice.outcome === 'accepted') console.log('PWA installÃ©e âœ…');
    }
  };

  document.getElementById('laterBtn').onclick = () => {
    toast.remove();
    localStorage.setItem('pwaPromptDismissed', true);
  };

  setTimeout(() => toast.remove(), 15000);
}

// Affichage aprÃ¨s 10s dâ€™inactivitÃ©
let idleTimer;
window.addEventListener('mousemove', resetTimer);
window.addEventListener('scroll', resetTimer);
window.addEventListener('touchstart', resetTimer);

function resetTimer() {
  clearTimeout(idleTimer);
  idleTimer = setTimeout(showInstallToast, 10000);
}

âœ… 6ï¸âƒ£ RÃ©sultat attendu

Une pop-up fluide, moderne et non intrusive.

Lâ€™utilisateur comprend le bÃ©nÃ©fice â†’ â€œaccÃ¨s rapideâ€.

Le CTA nâ€™interfÃ¨re plus avec les Ã©lÃ©ments du tableau de bord.

Lâ€™expÃ©rience devient propre, agrÃ©able et cohÃ©rente sur mobile.

ğŸ’¬ Note finale pour le dÃ©veloppeur :
Ce type de toast contextuel amÃ©liore la perception de qualitÃ© de la plateforme.
Il montre que lâ€™expÃ©rience utilisateur a Ã©tÃ© pensÃ©e jusquâ€™au dÃ©tail,
tout en respectant la hiÃ©rarchie visuelle et lâ€™attention du visiteur.
Câ€™est exactement le genre de finition qui fait paraÃ®tre CamionBack comme une app â€œpremiumâ€.